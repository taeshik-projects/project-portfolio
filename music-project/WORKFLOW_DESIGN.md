# String Quartet 편곡 자동화 워크플로우 설계

## 대식님의 핵심 인사이트 (2026-02-16)

### 0. 자동화 염두
모든 단계는 최대한 자동화 가능하도록 설계

### 1. 좋은 소스 찾기
- **문제:** IMSLP 오케스트라 스코어는 복잡하고 OMR이 읽기 힘듦
- **해결:** MuseScore.com 150만+ MusicXML 활용
- **나중:** Audiveris OMR + 사람 검수

### 2. 완벽한 악보 읽기
- **현실:** OMR은 80-90% 정확도, 사람 검수 필요
- **Phase 1:** 이미 깨끗한 MusicXML 사용
- **Phase 2:** OMR 툴 개발

### 3. ML 워크플로우 질문
- 원곡 → 코드진행 → 편곡 vs 원곡 → 편곡 (End-to-End)

---

## 추천 워크플로우: **하이브리드 접근**

### Phase 1: MVP (지금 구현 가능)

```
[1] 소스 수집
    MuseScore.com API
    → MusicXML 다운로드
    → 멜로디 추출

[2] 코드진행 추출 (AI/규칙)
    music21 화성 분석
    → 코드 시퀀스 생성
    → 대식님 검토/수정 (웹 UI)

[3] 편곡 생성 (규칙 기반)
    코드진행 + 멜로디
    → String Quartet 초안
    → 음역/보잉 최적화

[4] 최종 편집 (사람)
    MuseScore에서 열기
    → 대식님이 음악적 감성 추가
    → 완성!
```

### Phase 2: ML 강화 (3-6개월 후)

```
[2'] 코드진행 ML
    학습 데이터: iRealPro, Ultimate Guitar
    → Transformer 모델
    → 더 정확한 화성 분석

[3'] 편곡 ML
    학습 데이터: 대식님이 만든 편곡 100개+
    → Seq2Seq 모델
    → 대식님 스타일 학습
```

---

## 왜 하이브리드가 최선인가?

### End-to-End ML의 문제점
1. **데이터 부족:** 원곡-편곡 쌍 수만 개 필요 (존재하지 않음)
2. **Black box:** 오류 원인 파악 불가
3. **수정 불가:** 중간에 개입할 수 없음
4. **비용:** GPU 훈련 비용 높음

### 하이브리드의 장점
1. **적은 데이터:** 코드진행 데이터는 풍부함 (iRealPro 수십만 곡)
2. **투명성:** 코드 단계에서 검토 가능
3. **점진적 개선:** 규칙 → 규칙+ML → 완전 ML
4. **프로 개입:** 대식님이 코드 수정 → 편곡 품질 보장

---

## 구체적 기술 스택

### 소스 수집
- **LibreScore API** (MuseScore.com 다운로더)
- **music21** (MusicXML 파싱)

### 코드진행 추출
- **Phase 1:** music21 chord detection (규칙 기반)
- **Phase 2:** Transformer (학습 필요)

### 편곡 생성
- **Phase 1:** 규칙 기반 (우리가 이미 만든 `ode_to_joy_arranger.py`)
- **Phase 2:** Music Transformer / MuseNet 스타일

### 웹 인터페이스
- **React + Tone.js** (악보 재생)
- **MuseScore Web Component** (편집)
- **코드진행 편집 UI** (대식님이 수정)

---

## 데이터 파이프라인

### 학습 데이터 확보 전략

**코드진행 데이터:**
- iRealPro: 수만 곡 코드 차트
- Ultimate Guitar: 수십만 곡 코드
- Hooktheory: 분석된 코드진행

**편곡 데이터:**
1. **초기 (지금):** 대식님이 수동 편곡 (10-30개)
2. **성장 (6개월):** 고객 편곡 의뢰 (50-100개)
3. **스케일업 (1년):** 외주 편곡가 + 대식님 검수 (300+개)

---

## 실행 계획

### Week 1-2: 소스 수집 자동화
- [ ] LibreScore API 연동
- [ ] MuseScore.com 검색 → 다운로드 자동화
- [ ] MusicXML → 멜로디 추출 (Violin I or Melody track)

### Week 3-4: 코드진행 추출 개선
- [ ] music21 chord detection 테스트 (100곡)
- [ ] 정확도 측정
- [ ] 웹 UI: 코드진행 편집기

### Week 5-6: 편곡 규칙 고도화
- [ ] Ode to Joy 편곡 완성 (16마디)
- [ ] 다른 곡 5개 테스트
- [ ] 규칙 개선 (음역, 보잉, 다이내믹스)

### Week 7-8: 첫 10개 편곡 완성
- [ ] 대식님이 5곡 편곡
- [ ] 자동화로 5곡 편곡 (대식님 검수)
- [ ] Gumroad 업로드

---

## ML 도입 타이밍

### 지금 하지 않는 이유:
1. 데이터 없음 (편곡 쌍 0개)
2. 규칙 기반으로도 충분히 좋은 초안 가능
3. MVP 검증 먼저

### 6개월 후 ML 도입 조건:
1. ✅ 대식님 편곡 100개+ 확보
2. ✅ 고객이 실제 구매 (시장 검증)
3. ✅ 규칙 기반의 한계 명확히 파악

---

## 결론

**지금 할 일: 규칙 기반 하이브리드**
- 소스 수집 자동화
- 코드진행 추출 (music21)
- 편곡 규칙 고도화
- 대식님 검수 워크플로우

**나중 할 일: ML 강화**
- 데이터 확보 후 (100개+)
- 코드진행 ML 먼저
- 편곡 ML은 훨씬 나중

**핵심 철학:**
> "자동화는 사람을 대체하는 게 아니라, 사람의 시간을 10배 효율적으로 만드는 것"
> 
> 대식님의 음악적 판단은 절대 대체 불가능. 
> 자동화는 반복 작업(타이핑, 음역 배분 등)만 담당.
